# æ‰“å°è¿‡æ»¤è®¾ç½®æµ‹è¯•æ–‡æ¡£ v2

## æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº†é‡æ–°è®¾è®¡åçš„æ‰“å°è¿‡æ»¤è§„åˆ™ï¼Œç®€åŒ–ä¸º **5 ç§æ¸…æ™°ç‹¬ç«‹çš„æ¨¡å¼**ï¼Œæ¶ˆé™¤äº†åŸæœ‰è®¾è®¡ä¸­çš„é‡å¤å’Œå†²çªã€‚

## æµ‹è¯•æ–‡ä»¶ä½ç½®

```
src/stores/__tests__/printer.filter.spec.ts
```

## è¿è¡Œæµ‹è¯•

```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm run test:run

# å¸¦ UI è¿è¡Œæµ‹è¯•
npm run test:ui

# ç›‘å¬æ¨¡å¼è¿è¡Œæµ‹è¯•
npm run test
```

## æ–°è®¾è®¡ï¼š5 ç§è¿‡æ»¤æ¨¡å¼

### æ¨¡å¼å¯¹æ¯”è¡¨

| æ¨¡å¼ | ä»£ç  | å…³é”®è¯æ£€æŸ¥ | æ•°å­—æ£€æŸ¥ | ç¤ºä¾‹é€šè¿‡ | ç¤ºä¾‹ä¸é€šè¿‡ |
|------|------|-----------|---------|----------|------------|
| å…¨éƒ¨ | `all` | âŒ ä¸æ£€æŸ¥ | âŒ ä¸æ£€æŸ¥ | ä»»ä½•å†…å®¹ | - |
| çº¯æ•°å­— | `number_only` | âŒ ä¸æ£€æŸ¥ | âœ… å¿…é¡»çº¯æ•°å­— | 88ã€123 | æˆ‘è¦88å· |
| å«æ•°å­— | `contain_number` | âŒ ä¸æ£€æŸ¥ | âœ… å¿…é¡»åŒ…å« | 88ã€æˆ‘è¦88å· | åŠ æ²¹ |
| å…³é”®è¯ | `keyword` | âœ… å¿…é¡»åŒ…å« | âŒ ä¸æ£€æŸ¥ | æŠ¢å·ã€æˆ‘è¦ | 88ã€åŠ æ²¹ |
| å…³é”®è¯+æ•°å­— | `keyword_and_number` | âœ… å¿…é¡»åŒ…å« | âœ… å¿…é¡»åŒ…å« | æŠ¢88å· | 88ã€æŠ¢å· |

### ä¸ºä»€ä¹ˆé‡æ–°è®¾è®¡ï¼Ÿ

**åŸæœ‰é—®é¢˜ï¼š**

1. **æ¨¡å¼é‡å **ï¼š`keyword_number` åœ¨å…³é”®è¯ä¸ºç©ºæ—¶è¡Œä¸ºä¸ `number_only` ç›¸åŒ
2. **è¯­ä¹‰ä¸æ¸…**ï¼š`keyword_only` è®©ç”¨æˆ·è¯¯ä»¥ä¸ºæ˜¯"åªæœ‰å…³é”®è¯"è€Œé"åŒ…å«å…³é”®è¯"
3. **å†—ä½™é€‰é¡¹**ï¼š6 ç§æ¨¡å¼ä¸­æœ‰å¤šç§åœ¨ç‰¹å®šæ¡ä»¶ä¸‹è¡Œä¸ºç›¸åŒ

**æ–°è®¾è®¡åŸåˆ™ï¼š**

- æ¯ç§æ¨¡å¼æœ‰**ç‹¬ç«‹æ˜ç¡®**çš„è¯­ä¹‰
- æ²¡æœ‰é‡å æˆ–å†²çª
- å…³é”®è¯å’Œæ•°å­—æ£€æŸ¥**å®Œå…¨ç‹¬ç«‹**
- å…³é”®è¯ä¸ºç©ºæ—¶ï¼Œç›¸å…³æ¨¡å¼ä¼š**æ˜ç¡®æç¤º**å¹¶æ‹’ç»æ‰“å°

---

## å„æ¨¡å¼è¯¦ç»†è¯´æ˜

### 1. å…¨éƒ¨æ‰“å° (all)

**è¯´æ˜**ï¼šæ‰“å°æ‰€æœ‰èŠå¤©æ¶ˆæ¯ï¼Œä¸åšä»»ä½•å†…å®¹è¿‡æ»¤ã€‚

```typescript
// ä»»ä½•èŠå¤©å†…å®¹éƒ½æ‰“å°
'éšä¾¿ä»€ä¹ˆå†…å®¹' â†’ âœ… æ‰“å°
'88' â†’ âœ… æ‰“å°
'' â†’ âœ… æ‰“å°
'ğŸ‰ğŸŠ' â†’ âœ… æ‰“å°

// éèŠå¤©æ¶ˆæ¯ä»ç„¶è¢«è¿‡æ»¤
{ type: 'like' } â†’ âŒ è¿‡æ»¤
{ type: 'follow' } â†’ âŒ è¿‡æ»¤
```

---

### 2. çº¯æ•°å­— (number_only)

**è¯´æ˜**ï¼šå†…å®¹å¿…é¡»æ˜¯çº¯æ•°å­—ï¼ˆå»é™¤ç©ºæ ¼ååªæœ‰æ•°å­—ï¼‰ï¼Œä¸”æ•°å­—åœ¨è®¾ç½®çš„èŒƒå›´å†…ã€‚

**é€‚ç”¨åœºæ™¯**ï¼šæŠ½å¥–ã€æŠ¢å·ç­‰éœ€è¦ç”¨æˆ·å‘é€çº¯æ•°å­—çš„åœºæ™¯ã€‚

```typescript
// è®¾ç½®
filter_mode: 'number_only'
filter_number_min: 0
filter_number_max: 100

// çº¯æ•°å­—ï¼ŒèŒƒå›´å†… â†’ æ‰“å°
'50' â†’ âœ…
'88' â†’ âœ…
'  99  ' â†’ âœ… (æ”¯æŒå‰åç©ºæ ¼)

// çº¯æ•°å­—ï¼Œè¶…å‡ºèŒƒå›´ â†’ è¿‡æ»¤
'101' â†’ âŒ
'999' â†’ âŒ

// ä¸æ˜¯çº¯æ•°å­— â†’ è¿‡æ»¤
'æˆ‘è¦88å·' â†’ âŒ
'88å·' â†’ âŒ
'ç¬¬88' â†’ âŒ
'3.14' â†’ âŒ (å°æ•°)
'-50' â†’ âŒ (è´Ÿæ•°)

// ä¸åŒ…å«æ•°å­— â†’ è¿‡æ»¤
'åŠ æ²¹' â†’ âŒ
```

---

### 3. åŒ…å«æ•°å­— (contain_number)

**è¯´æ˜**ï¼šå†…å®¹åŒ…å«æ•°å­—å³å¯ï¼Œæ•°å­—éœ€åœ¨è®¾ç½®çš„èŒƒå›´å†…ã€‚ä¸æ£€æŸ¥å…³é”®è¯ã€‚

**é€‚ç”¨åœºæ™¯**ï¼šå®½æ¾çš„æ•°å­—åŒ¹é…ï¼Œå¦‚"æˆ‘è¦88å·"ä¹Ÿèƒ½æ‰“å°ã€‚

```typescript
// è®¾ç½®
filter_mode: 'contain_number'
filter_number_min: 0
filter_number_max: 100

// åŒ…å«æ•°å­—ï¼ŒèŒƒå›´å†… â†’ æ‰“å°
'88' â†’ âœ…
'æˆ‘è¦88å·' â†’ âœ…
'æ¥äº†88ä¸ªäºº' â†’ âœ…
'ç¬¬50å' â†’ âœ…

// åŒ…å«å¤šä¸ªæ•°å­—ï¼Œå…¶ä¸­ä¸€ä¸ªåœ¨èŒƒå›´å†… â†’ æ‰“å°
'ä»150åˆ°50' â†’ âœ… (50 åœ¨èŒƒå›´å†…)

// æ•°å­—å…¨éƒ¨è¶…å‡ºèŒƒå›´ â†’ è¿‡æ»¤
'æˆ‘è¦150å·' â†’ âŒ
'ä»150åˆ°200' â†’ âŒ

// ä¸åŒ…å«æ•°å­— â†’ è¿‡æ»¤
'åŠ æ²¹å•Š' â†’ âŒ
'æˆ‘è¦å‚ä¸' â†’ âŒ
```

> **æ³¨æ„**ï¼šæ­¤æ¨¡å¼ä¸æ£€æŸ¥å…³é”®è¯ï¼Œå³ä½¿è®¾ç½®äº†å…³é”®è¯ä¹Ÿä¼šè¢«å¿½ç•¥ã€‚

---

### 4. å…³é”®è¯ (keyword)

**è¯´æ˜**ï¼šå†…å®¹å¿…é¡»åŒ…å«è‡³å°‘ä¸€ä¸ªè®¾ç½®çš„å…³é”®è¯ã€‚ä¸æ£€æŸ¥æ•°å­—ã€‚

**é€‚ç”¨åœºæ™¯**ï¼šéœ€è¦ç”¨æˆ·å‘é€ç‰¹å®šå…³é”®è¯å‚ä¸çš„åœºæ™¯ï¼Œå¦‚"æŠ¢"ã€"è¦"ã€‚

```typescript
// è®¾ç½®
filter_mode: 'keyword'
filter_keywords: ['æŠ¢', 'è¦', 'å‚ä¸']

// åŒ…å«å…³é”®è¯ â†’ æ‰“å°
'æˆ‘è¦å‚ä¸' â†’ âœ…
'æŠ¢ä¸€ä¸ª' â†’ âœ…
'æˆ‘è¦88å·' â†’ âœ… (æœ‰å…³é”®è¯å°±è¡Œï¼Œä¸ç®¡æœ‰æ²¡æœ‰æ•°å­—)

// ä¸åŒ…å«å…³é”®è¯ â†’ è¿‡æ»¤
'åŠ æ²¹' â†’ âŒ
'88' â†’ âŒ
'æ¥äº†88ä¸ª' â†’ âŒ

// âš ï¸ å…³é”®è¯åˆ—è¡¨ä¸ºç©ºæ—¶ï¼Œå…¨éƒ¨è¿‡æ»¤
filter_keywords: []
'ä»»ä½•å†…å®¹' â†’ âŒ (ä¼šæç¤º"è¯·å…ˆè®¾ç½®å…³é”®è¯")
```

> **é‡è¦**ï¼šå¦‚æœå…³é”®è¯åˆ—è¡¨ä¸ºç©ºï¼Œæ­¤æ¨¡å¼ä¸ä¼šæ‰“å°ä»»ä½•å†…å®¹ã€‚UI ä¼šæ˜¾ç¤ºè­¦å‘Šæç¤ºã€‚

---

### 5. å…³é”®è¯+æ•°å­— (keyword_and_number)

**è¯´æ˜**ï¼šå†…å®¹å¿…é¡»**åŒæ—¶**åŒ…å«å…³é”®è¯å’Œæ•°å­—ï¼Œæ•°å­—éœ€åœ¨èŒƒå›´å†…ã€‚

**é€‚ç”¨åœºæ™¯**ï¼šéœ€è¦ç”¨æˆ·å‘é€"å…³é”®è¯+æ•°å­—"æ ¼å¼çš„åœºæ™¯ï¼Œå¦‚"æŠ¢88å·"ã€‚

```typescript
// è®¾ç½®
filter_mode: 'keyword_and_number'
filter_keywords: ['æŠ¢', 'è¦']
filter_number_min: 0
filter_number_max: 100

// åŒæ—¶åŒ…å«å…³é”®è¯å’Œæ•°å­—ï¼ˆèŒƒå›´å†…ï¼‰ â†’ æ‰“å°
'æˆ‘è¦88å·' â†’ âœ…
'æŠ¢66' â†’ âœ…
'è¦ç¬¬50å' â†’ âœ…

// åªæœ‰å…³é”®è¯ï¼Œæ²¡æœ‰æ•°å­— â†’ è¿‡æ»¤
'æˆ‘è¦å‚ä¸' â†’ âŒ
'æŠ¢ä¸€ä¸ª' â†’ âŒ

// åªæœ‰æ•°å­—ï¼Œæ²¡æœ‰å…³é”®è¯ â†’ è¿‡æ»¤
'88' â†’ âŒ
'æ¥äº†88ä¸ª' â†’ âŒ

// æœ‰å…³é”®è¯ä½†æ•°å­—è¶…å‡ºèŒƒå›´ â†’ è¿‡æ»¤
'æˆ‘è¦150å·' â†’ âŒ

// âš ï¸ å…³é”®è¯åˆ—è¡¨ä¸ºç©ºæ—¶ï¼Œå…¨éƒ¨è¿‡æ»¤
filter_keywords: []
'æˆ‘è¦88å·' â†’ âŒ
```

---

## é«˜çº§è¿‡æ»¤é€‰é¡¹

é«˜çº§é€‰é¡¹å¯ä»¥ä¸ä»»ä½•æ¨¡å¼ç»„åˆä½¿ç”¨ã€‚

### æ— ç¯ç‰Œä¸æ‰“å° (filter_require_badge)

```typescript
filter_require_badge: true

{ has_badge: true } â†’ âœ… ç»§ç»­æ£€æŸ¥å…¶ä»–æ¡ä»¶
{ has_badge: false } â†’ âŒ ç›´æ¥è¿‡æ»¤
{ has_badge: undefined } â†’ âŒ ç›´æ¥è¿‡æ»¤
```

### é™åˆ¶å‰Xä½æ‰“å° (filter_limit_count)

```typescript
filter_limit_count: 3

ç¬¬1æ¡ â†’ âœ… (printCounter = 1)
ç¬¬2æ¡ â†’ âœ… (printCounter = 2)
ç¬¬3æ¡ â†’ âœ… (printCounter = 3)
ç¬¬4æ¡ â†’ âŒ (è¶…è¿‡é™åˆ¶)

// é‡ç½®è®¡æ•°å™¨åå¯ç»§ç»­æ‰“å°
resetPrintCounter()
ç¬¬5æ¡ â†’ âœ… (printCounter = 1)

// è®¾ç½®ä¸º0è¡¨ç¤ºä¸é™åˆ¶
filter_limit_count: 0 â†’ æ— é™åˆ¶
```

### æ•°å­—å»é‡ (filter_dedupe_seconds)

```typescript
filter_dedupe_seconds: 5 // 5ç§’å†…ç›¸åŒæ•°å­—ä¸é‡å¤

'88' â†’ âœ… (ç¬¬1æ¬¡)
'88' â†’ âŒ (5ç§’å†…é‡å¤)
'99' â†’ âœ… (ä¸åŒæ•°å­—)

// è®¾ç½®ä¸º0è¡¨ç¤ºä¸å»é‡
filter_dedupe_seconds: 0 â†’ ä¸å»é‡
```

### æ•°å­—èŒƒå›´ (filter_number_min / filter_number_max)

```typescript
filter_number_min: 10
filter_number_max: 20

'15' â†’ âœ… (åœ¨èŒƒå›´å†…)
'10' â†’ âœ… (è¾¹ç•Œ)
'20' â†’ âœ… (è¾¹ç•Œ)
'9' â†’ âŒ (ä½äºæœ€å°å€¼)
'21' â†’ âŒ (é«˜äºæœ€å¤§å€¼)
```

---

## æµ‹è¯•è¦†ç›–

å½“å‰æµ‹è¯•ç”¨ä¾‹è¦†ç›–ï¼š

| æµ‹è¯•åˆ†ç±» | ç”¨ä¾‹æ•° |
|----------|--------|
| æ¶ˆæ¯ç±»å‹è¿‡æ»¤ | 6 |
| å…¨éƒ¨æ‰“å°æ¨¡å¼ | 4 |
| çº¯æ•°å­—æ¨¡å¼ | 13 |
| åŒ…å«æ•°å­—æ¨¡å¼ | 7 |
| å…³é”®è¯æ¨¡å¼ | 6 |
| å…³é”®è¯+æ•°å­—æ¨¡å¼ | 6 |
| ç¯ç‰Œè¿‡æ»¤ | 3 |
| æ•°é‡é™åˆ¶ | 3 |
| æ•°å­—å»é‡ | 2 |
| ç»„åˆè§„åˆ™ | 2 |
| è¾¹ç•Œæƒ…å†µ | 5 |
| ç”¨æˆ·ç­‰çº§è¿‡æ»¤ | 4 |

**æ€»è®¡ï¼š61 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼Œ100% é€šè¿‡**

---

## ç›¸å…³æ–‡ä»¶

- `src/stores/printer.ts` - è¿‡æ»¤é€»è¾‘å®ç°
- `src/components/FilterSettings.vue` - è¿‡æ»¤è®¾ç½® UI ç»„ä»¶
- `src/views/LiveRoom.vue` - ç›´æ’­é—´é¡µé¢

---

## å˜æ›´å†å²

| æ—¥æœŸ | ç‰ˆæœ¬ | å˜æ›´å†…å®¹ |
|------|------|----------|
| 2024-12-04 | v2 | é‡æ–°è®¾è®¡è¿‡æ»¤æ¨¡å¼ï¼Œç®€åŒ–ä¸º5ç§æ¸…æ™°ç‹¬ç«‹çš„æ¨¡å¼ï¼Œæ¶ˆé™¤é‡å¤å’Œå†²çª |
| 2024-12-04 | v1 | åˆç‰ˆï¼Œ6ç§æ¨¡å¼ï¼Œå­˜åœ¨é‡å å’Œå†²çªé—®é¢˜ |
